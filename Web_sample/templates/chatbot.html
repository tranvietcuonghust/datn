<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Chi tiết</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="{{url_for('static', filename='/img/favicon.ico')}}" type="image/x-icon">


    <!-- Font awesome -->
    <link href="{{url_for('static', filename='css/font-awesome.css')}}" rel="stylesheet">
    <!-- Bootstrap -->
    <link href="{{url_for('static', filename='css/bootstrap.css')}}" rel="stylesheet">
    <!-- slick slider -->
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/slick.css')}}">
    <!-- price picker slider -->
    <link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/nouislider.css')}}">
    <!-- Fancybox slider -->
    <link rel="stylesheet" href="{{url_for('static', filename='css/jquery.fancybox.css')}}" type="text/css" media="screen" />
    <!-- Theme color -->
    <link id="switcher" href="{{url_for('static', filename='css/theme-color/default-theme.css')}}" rel="stylesheet">

    <!-- Main style sheet -->
    <link href="{{url_for('static', filename='css/style.css')}}" rel="stylesheet">


    <!-- Google Font -->
    <link href='https://fonts.googleapis.com/css?family=Vollkorn' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      #chatbox {
        display: inline-block;
      }

      .message-box::-webkit-scrollbar {
        display: none;
      }
      .message-box {
        width: 90vw;
        margin-left: 5vw;
        height: 80vh;
        padding-top: 30px;
        overflow-y: scroll;
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;
      }

      .message-box .bot-answer {
        display: inline-block;
        border-radius: 5px;
        background-color: #428af5;
        border: 1px solid #428af5;
        max-width: 50vw;
        overflow: hidden;
        margin-top: 30px;
        color: #ffffff;
        padding: 5px;
      }

      .message-box .bot-answer .list-items-property {
        text-align: center;
        max-width: 50vw;
      }
      .message-box .bot-answer .list-items-property .item-property {
        display: inline-block;
        max-width: 200px;
        overflow: hidden;
        margin-right: 20px;
        padding-top: 20px;
        text-align: left;
      }

      .message-box .bot-answer .item-property img {
        height: 200px;
        width: 200px;
        background-position: center center;
        background-repeat: no-repeat;
      }

      .user-bounder {
        direction: rtl;
      }

      .user-message {
        max-width: 40vw;
        margin-top: 30px;
        padding: 5px;
        border-radius: 5px;
        background-color: #d2d4d2;
        display: inline-block;
      }

      .enter-message {
        padding-top: 30px;
        width: 90vw;
        margin-left: 5vw;
        padding-bottom: 30px;
      }

      .enter-message span {
        display: inline-block;
      }

      .enter-message span input {
        width: 80vw;
        border: 1px solid #428af5;
        height: 40px;
        border-radius: 5px;
        padding-left: 10px;
        padding-right: 10px;
      }

      .enter-message span button {
        width: 9vw;
        height: 40px;
        background-color: #428af5;
        border: 1px solid #428af5;
        color: #ffffff;
        font-weight: bold;
        border-radius: 5px;
      }
    </style>

  </head>
  <body class="aa-price-range">

  {% include 'header.html' %}
  {% include 'menu.html' %}

  <!-- Start Proerty header  -->

  <section id="aa-property-header">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="aa-property-header-inner">
            <h2>TƯ VẤN TRỰC TUYẾN</h2>
            <ol class="breadcrumb">
            <li><a href="/">Trang chủ</a></li>
            <li class="active">Chatbot</li>
          </ol>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- End Proerty header  -->

  <section id="chatbox">
    <div class="message-box" id="message-box">
      <div class='bot-answer'>Xin chào! Tôi có thể giúp gì cho bạn?</div>
    </div>
  </section>

  <section id="message">
    <div class="enter-message">
      <span><input name="query" id="query" placeholder="Please enter your message here"></span>
      <span><button id="send-message">Send</button></span>
    </div>
  </section>

  {% include 'footer.html' %}

  <!-- jQuery library -->
  <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->
  <script src="{{url_for('static', filename='js/jquery.min.js')}}"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="{{url_for('static', filename='js/bootstrap.js')}}"></script>
  <!-- slick slider -->
  <script type="text/javascript" src="{{url_for('static', filename='js/slick.js')}}"></script>
  <!-- Price picker slider -->
  <script type="text/javascript" src="{{url_for('static', filename='js/nouislider.js')}}"></script>
   <!-- mixit slider -->
  <script type="text/javascript" src="{{url_for('static', filename='js/jquery.mixitup.js')}}"></script>
  <!-- Add fancyBox -->
  <script type="text/javascript" src="{{url_for('static', filename='js/jquery.fancybox.pack.js')}}"></script>
  <!-- Custom js -->
  <script src="{{url_for('static', filename='js/custom.js')}}"></script>

  <script type="text/javascript">
    $('#send-message').on('click', function () {
      let query = $('#query').val();
      let content = $('#message-box').html();

      content = content + `<div class="user-bounder"><div class='user-message'>${query}</div></div>`;
      $('#message-box').html(content);
      $("#message-box").animate({
        scrollTop: $('#message-box')[0].scrollHeight - $('#message-box')[0].clientHeight
      }, 300);

      $.ajax('/chatbot',
                {
                    method: 'post',
                    dataType: 'text',
                    data: {'query': query},
                    timeout: 60000,
                    success: function (data,status,xhr) {
                        content = content + data;
                        $('#message-box').html(content);
                        $("#message-box").animate({
                          scrollTop: $('#message-box')[0].scrollHeight - $('#message-box')[0].clientHeight
                        }, 300);
                    },
                    error: function (jqXhr, textStatus, errorMessage) {
                        content = content + "<div class='bot-answer'>Xin lỗi! Chúng tôi không thể kết nối với bạn!</div>";
                        $('#message-box').html(content);
                        $("#message-box").animate({
                          scrollTop: $('#message-box')[0].scrollHeight - $('#message-box')[0].clientHeight
                        }, 300);
                    }
                }
            );
      $('#query').val("");
    });
  </script>
  </body>
</html>